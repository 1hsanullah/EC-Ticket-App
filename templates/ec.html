{% extends 'base.html' %}

{% block head %}
	<title>Extenuating Circumstance Form</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
	<link rel="stylesheet" href="{{ url_for('static', filename='css/ec.css') }}">
{% endblock %}

{% block body %}
{% if session['role'] == 'student' %}
	<h1>Extenuating Circumstance Form</h1>
	<form method="POST" action="{{ url_for('ec') }}" enctype = "multipart/form-data">
    <div class="wrapper">
      <input type="radio" name="claim_type" id="option-1" checked onchange="toggleRequired()">
      <input type="radio" name="claim_type" id="option-2" onchange="toggleRequired()">
        <label for="option-1" class="option option-1">
          <div class="dot"></div>
           <span>Standard</span>
           </label>
        <label for="option-2" class="option option-2">
          <div class="dot"></div>
           <span>Self Certified</span>
        </label>
     </div>
		<fieldset>
			<legend>Course Information</legend>
			<label for="course_name" class="required">Course Name:</label>
			<input type="text" id="course_name" name="course_name" required>

			<label for="instructor" class="required">Course Instructor:</label>
			<input type="text" id="instructor" name="instructor" required>
		</fieldset>

		<fieldset>
			<legend>Description of Circumstance</legend>
			<label for="description" class="required">Please provide a detailed explanation of your extenuating circumstance. Include any relevant dates and supporting documentation.</label>
			<textarea id="description" name="description" required></textarea>
		</fieldset>
    <fieldset>
      <legend>Supporting Documentation</legend>
      <label for="evidence" id="evidenceLabel" class="required">Upload any relevant files as evidence:</label>
      <input type="file" id="evidence" name="evidence" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" required>
    </fieldset>

		<input type="submit" value="Submit">
	</form>
  <script>
  function toggleRequired() {
    if (document.getElementById('option-1').checked) {
      document.getElementById('evidence').required = true;
      document.getElementById('evidenceLabel').classList.add('required');
    } else if (document.getElementById('option-2').checked) {
      document.getElementById('evidence').required = false;
      document.getElementById('evidenceLabel').classList.remove('required');
    }
  }
  </script>
{% elif session['role'] == 'admin' %} {% if ecs|default %}
<h1>ECs</h1>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Course Name</th>
      <th>Instructor</th>
      <th>Description</th>
      <th>Status</th>
      <th>Created</th>
      <th>Evidence</th>
    </tr>
  </thead>
  <tbody>
    {% for claim in ecs %}
    <tr>
      <td>{{ claim[0] }}</td>
      <td>{{ claim[1] }}</td>
      <td>{{ claim[2] }}</td>
      <td>{{ claim[3] }}</td>
      <td>{{ claim[4] }}</td>
      <td>{{ claim[5] }}</td>
      <td>
        {% if claim[6] %}
        <a href="{{ url_for('static', filename='uploads/' + claim[6]) }}" target="_blank">View Evidence</a>
        {% else %}
        No Evidence
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% else %} {% endif %} {% else %}
<p>You are logged in as {{ username }}</p>
<p>You don't have privileges to access this page.</p>
{% endif %} {% endblock %}